# Переосмысление отзывчивого svg

Если вы ещё не знакомы с техникой отзывчивых иконок [Джо Харрисона][1] (Joe Harrison), то, скорее всего, будете впечатлены так же сильно, как и я, когда впервые открыл ее для себя. В этой статье я бы хотел исследовать, что мы можем делать с SVG за пределами традиционной практики замены PNG. В частности, мы можем рассматривать **svg как независимый модуль**, который включает в себя CSS для кастомизации вариантов отображения; также как и правила для отзывчивого поведения, SVG может содержать в себе JavaScript для логики взаимодействий. Теперь давайте рассмотрим эту технику детальнее.

## Отзывчивый SVG: метод для нищебродов

Сайт с отзывчивыми иконками Харрисона устроен достаточно просто. Он создан на основе всем известной техники спрайтов. Если Вы всё ещё не знакомы со спрайтами, позвольте я объясню. Спрайт картинок — это техника, которая прежде использовалась только для растровых изображений, чтобы уйти от проблемы медленных сетей. Главная идея в том, чтобы **объединить множество мелких изображений в единый файл**, чтобы таким образом пользователь загружал с сервера только один файл с изображениями.

Для использования спрайта необходимо css позиционирование, чтобы отображался только нужный участок картинки, таким образом пользователю нет нужды загружать каждое изображение по отдельности. (Почитать детальнее о спрайтах можно на [CSS-Tricks][2])

Техника Харрисона делает тоже самое, только в отличие от PNG в спрайтах, используется SVG. Если объединить все изображения в один файл, вот что мы получим:

![svg_sprite][1-giant]

В дальнейшем этот файл будет установлен в качестве бекграунда для контейнера, в котором одна из иконок и будет отображаться:

    .icon {
        width: 300px;
        height: 300px;
        background: url(../images/home_sprite.svg);
        background-position: center top;
    }

Пример, описанный выше, очень простой, но он имеет определенные недостатки. И избавить его от них не так-то просто. Фактически, для того, чтобы всё работало, нужны две составляющие: внешний CSS и собственно SVG спрайт.

**Отзывчивый SVG: метод для бедных**

Поскольку CSS может быть помещён в SVG, давайте рассмотрим представленный пример и сделаем иконку более портативной.

Для начала уберём все пустые места иконок в спрайте. Конечно же, это создаст многослойный бардак из иконок: [пример на CodePan][3].

Далее давайте переместим все формы и сгруппируем их для каждой иконки, добавляя класс `.icon` для каждой из груп и порядковый номер, чтобы было легче идентифицировать каждую (напимер `#home_icon_0`, `#home_icon_1` и так до `#home_icon_8`):

    <svg>
        <g id="home_icon_0" class="icon">
            <!-- paths and shapes -->
        </g>
    
        <!-- ... -->
    
        <g id="home_icon_8" class="icon">
            <!-- paths and shapes -->
        </g>
    </svg>

Теперь мы готовы к добавлению media queries, чтобы таким образом мы могли выбирать иконку для отображения из нашего SVG. Это возможно с помощью написания CSS непосредственно в тег <svg> используя для этого <defs>.

    <svg>
        <defs>
            <style>
            /* Hide all of the icons first. */
            .icon {
                display: none;
            }
    
            /* Display the first one. */
            #home_icon_0 {
                display: block;
            }
    
            /* Display the desired icon and hide the others according to the viewport's size. */
            @media screen and (min-width: 25em) {
    
                #home_icon_0 {
                    display: none;
                }
    
                #home_icon_1 {
                    display: block;
                }
            }
    
            @media screen and (min-width: 30em) {
                #home_icon_1 {
                    display: none;
                }
    
                #home_icon_2 {
                    display: block;
                }
            }
    
            /* And so on */
    
            </style>
        </defs>
    
    <!-- Icon groups go here -->
    
    </svg>

В результате мы получим те же иконки, которые будут адаптироваться под ширину видимого поля, только теперь этим правит CSS, media queries и SVG, формы которых совмещены непосредственно в самом SVG файле. 

Можете просмотреть этот [пример на CodePan][4], изменяя ширину браузера.

**Отзывчивый SVG: метод для : The Man With A Gun**

Пример выше выглядит уже гораздо лучше, но вопрос все еще остаеться открытым:

<ul>
    <li>Возможно ли реализовать SVG лучшим способом?</li>
    <li>Можно ли использовать отзывчивый подход для отображения иконки и кастомизации ее элементов, вместо простого прятания/показывания частей файла?</li>
</ul>

Если на регулярной основе рассматривать приемы реструктуризации лейаута и контента в отзывчивом дизайне можно продолжить совершенствовать прототип. Например, можно использовать изменение формы и трансформации для адаптации иконок к разным размерам вьюпорта.

Для начала, давайте перерисуем самую большую и детализированую иконку дома в нашей спрайте, разделяя все пути и соединенные формы в элементарные формы. Результат будет читаться гораздо легче и теперь возможно применение трансформаций на любую часть иконки: [пример на CodePan][5].

Наша перерисованная иконка выглядит точно так же, как и большой спрайт выглядел до этого, но содержит гораздо больше форм и занимает меньше места. Магия в том, что мы добавляем media queries и трансформации в новый вариант, изменяя формы иконки и тот же результат, что и в случае с SVG спрайтом.

    <svg>
        <defs>
            <style>
            @media screen and (max-width: 65em) {
    
                #door-shadow, #tube-shadow, .backyard {
                    display: none;
                }
    
                #door-body {
                    fill: white;
                }
    
                #door-handle {
                    fill: #E55C3C;
                }
    
                #door-body, #door-handle {
                    -ms-transform: translate(0,0);
                    -webkit-transform: translate(0,0);
                    transform: translate(0,0);
                }
    
                #window {
                    -ms-transform: translate(0,0) scale(1);
                    -webkit-transform: translate(0,0) scale(1);
                    transform: translate(0,0) scale(1);
                }
    
                #house-body {
                    -ms-transform: scaleX(1) translate(0, 0);
                    -webkit-transform: scaleX(1) translate(0, 0);
                    transform: scaleX(1) translate(0, 0);
                }
    
                #tube-body {
                    -ms-transform: translate(0, 0);
                    -webkit-transform: translate(0, 0);
                    transform: translate(0, 0);
                }
    
                #tube-upper {
                    -ms-transform: translate(0, 0);
                    -webkit-transform: translate(0, 0);
                    transform: translate(0, 0);
                }
            }
    
            /* And so on */
    
            </style>
        </defs>
    
    <!-- Icon groups go here -->
    
    </svg>

Как только мы добавим немного магии трансформаций, наша иконка будет вести себя точно так же, как и пример Джо Харрисона, с той лишь разницей, что у нас все будет содержаться в едином файле.

[Пример на CodePen][6].

**Адаптируем иконки и подгоняем к размеру родительского контейнера**

И ещё один момент. Также возможно изменять иконку в зависимости от изменения высоты или ширины родительского элемента.

Для этого я попробовал загрузить SVG в виде элемента `img`,  который был заключен в `div`. Но ни единая из media query в SVG файле не сработала.

Моя следующая попытка была загрузить иконку в изменяющийся элемет `object`,
заключенный в `div`. После того, как я это проделал, все media query заработали. Более того, теперь можно сделать так, чтобы объект заполнял пространство родителя. (Не забудьте установить такие атрибуты как ширина и высота на 100% для `svg`, или уберите их вовсе).

    <div style="width: 100%; margin: 0 auto;">
        <object>
            <embed src="responsive3.svg" style="width: 100%; height: auto;" />
        </object>
    </div>

Существуют и другие способы внедрения SVG, с media queries и трансформациями, для этого можно использовать SVG как бекграунд картинку на любой блочный элемент. SVG на линейные элементы тоже допустим, но тогда media queries будут реагировать только на общую видимую область (viewport).

Пример ниже демонстрирует, как иконка реагирует на разные размеры контейнера.

Помещённые внутри SVG media queries задают поведение иконок, в зависимости от размеров в которых будет рендериться SVG. Вот [пример на CodePan][7] одного и того же SVG который вмещает восемь блоков разного размера.

**Добавление JAVASCRIPT в SVG**

Еще больше хороших новостей! SVG может содержать не только таблицы стилей, но также и JavaScript. Таким образом мы можем рассматривать SVG как отдельный и независимый модуль, к которому также может применяться любой язык разметки предыдущих версий.

JavaScript отлично работает в SVG когда последовательно (inline) включен в `<object>`. Разве это не замечательный мир?

**Поддержка браузеров**

Последний и самый комплексный пример отлично работает в следующих браузерах:

<ul>
    <li>Internet Explorer 9+</li>
    <li>Firefox 17+</li>
    <li>Chrome 17+</li>
    <li>Opera 15+</li>
    <li>Safari 6.0+</li>
    <li>Safari on iOS 6.0+</li>
    <li>Android browser on Android 3.0+</li>
</ul>

Данная техника может работать и в других браузерах более старых версий, но в них не будут отрабатывать трансформации, такие как например масштабирование.

**Заключение**

Отзывчивые SVG инонки могут использоваться во многих случаях, включая следующие:

<ul>
    <li>отзывчивая реклама (площадь для рекламы будет занимать всю область, отведённую ей в документе, и, учитывая что CSS и JavaScript работают, большинство действий будут содержаться в едином рекламном SVG файле)</li>
    <li>логотипы</li>
    <li>иконки приложений</li>
</ul>

Я должен также отметить, что нет ничего плохого в использовании практики со спрайтами, которую предложил Джо Харрисон. Она работает, и она необходима в некоторых случаях!

Мысли? Отзывы? Вносите предложения и комментарии.

Веселитесь и развлекайтесь!


[1-giant]: img/1-giant.png "большой спрайт"

[0]: https://twitter.com/@pukhalski
[1]: http://responsiveicons.co.uk/
[2]: http://css-tricks.com/css-sprites/
[3]: http://codepen.io/pukhalski/pen/inxym
[4]: http://codepen.io/pukhalski/pen/uxIKB
[5]: http://codepen.io/pukhalski/pen/Azqyn
[6]: http://codepen.io/pukhalski/pen/hFLDG
[7]: http://codepen.io/pukhalski/pen/hszLl
